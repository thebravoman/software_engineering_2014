require "csv"
folder_name = ["vhodno_nivo","class002_homework", "class003_homework","class004","class009_homework","class012_homework"]
vh = Hash.new { |name, programs| name[programs] = []}
results = Hash.new{|hash, key| hash[key] = [0,0,0,0,0,0]}

dir = ARGV[0]+"folder_name[0]/**/*.*"
puts dir
Dir.glob(ARGV[0]+"/vhodno_nivo/**/*.*").each do |repository|
	prog_name = repository.split("/").last
	name = prog_name.reverse.split("_", 2).last.reverse.gsub("_"," ")
	program = prog_name.split(".").first.split("_").last
	git_log = `git log --until=17.09.2014:20:00:00 #{repository}` 	

	if prog_name.include? "_" then counter = prog_name.count "_" end
	i = 2
	bool = false
	2.upto(18) {  
		if program.to_i == i then bool = true end 
		i += 1
	}

	vh["#{name}"] << prog_name if ((bool == true) && (counter == 2))
	if !git_log.empty?
		results[name][0] = 2
	elsif git_log.empty?
		results[name][0] = 1
	else
		results[name][0] = 0	
	end
end

vh.each do |key, value| 
	if value.uniq.count >= 3 
		results.each do |key, value|
			print [key, value].flatten
			puts
		end
	end
end
