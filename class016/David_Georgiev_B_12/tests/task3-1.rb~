require 'csv'

argcsv = ARGV[0].split(/\//).last
argfolder = ARGV[1]

students = Hash.new

CSV.foreach("#{argcsv}") do |row|
	Dir.glob("#{argfolder}/*").each do |dir|
		r1 = row[0]
		r2 = row[1]
p r1
p r2
		d1 = dir.split("_").first.split(/\//).last
		d2 = dir.split("_")[1]
p d1
p d2
		if r1 != nil && r2 != nil && d1 != nil && d2 != nil
			students[r1] = r2 if r1 == d1 && r2 == d2 && r1.length == 10
		end
	end
end

CSV.open("results31.csv", "w") do |csv|
	 Hash[students.sort_by { |first, last| last }.reverse].each do |first, last|
    	csv << [ first, last ]
	end
   #  puts "#{first},#{last}"
end
